<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clínica Odontológica DaVas - Jr. Los Laureles, Juliaca</title>
  <meta name="description" content="Clínica DaVas - Reserva citas y consulta procedimientos." />
  <style>
    :root{--accent:#0077b6;--muted:#666;--card:#f8f9fb}
    *{box-sizing:border-box;font-family:Inter, system-ui, Arial, Helvetica, sans-serif}
    body{margin:0;background:#fff;color:#222}
    header{background:linear-gradient(90deg,var(--accent),#00a6ff);color:white;padding:18px}
    .container{max-width:1100px;margin:18px auto;padding:0 16px}
    h1,h2{margin:0 0 10px}
    .grid{display:grid;gap:16px}
    .cols-3{grid-template-columns:repeat(3,1fr)}
    .cols-2{grid-template-columns:repeat(2,1fr)}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.06)}
    label{display:block;font-size:14px;margin-bottom:6px;color:var(--muted)}
    input[type=text],input[type=email],input[type=date],input[type=time],select,textarea{width:100%;padding:8px;border-radius:6px;border:1px solid #ddd}
    button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}
    .procedimientos{display:flex;flex-wrap:wrap;gap:12px}
    .proc-card{width:calc(33% - 8px);min-width:200px}
    .proc-card img{width:100%;border-radius:8px;height:140px;object-fit:cover}
    .row{display:flex;gap:12px;align-items:center}
    .socials a{display:inline-block;margin-right:8px;text-decoration:none}
    footer{padding:12px;text-align:center;color:var(--muted);font-size:14px}
    .small{font-size:13px;color:var(--muted)}
    @media(max-width:900px){.cols-3{grid-template-columns:1fr}.proc-card{width:100%}}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.45)}
    .modal.open{display:flex}
    .modal .box{width:96%;max-width:720px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid #eee;text-align:left}
    .pill{background:#eef7ff;color:var(--accent);padding:6px 8px;border-radius:999px;font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <h1>Clínica Odontológica DaVas</h1>
        <div class="small">Jr. Los Laureles, Juliaca - Puno - Perú</div>
      </div>
      <div>
        <button id="openAdminBtn">Acceso administrador</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="grid cols-3">
      <div class="card">
        <h2>Registro de pacientes</h2>
        <p class="small">Registre al paciente para reservar una cita. La información se guarda localmente en el navegador.</p>
        <form id="registerForm">
          <label>Nombre completo</label>
          <input type="text" id="p_name" required />
          <label>DNI / Documento</label>
          <input type="text" id="p_doc" required />
          <label>Teléfono</label>
          <input type="text" id="p_phone" />
          <label>Email</label>
          <input type="email" id="p_email" />
          <label>Fecha preferida</label>
          <input type="date" id="p_date" />
          <label>Hora preferida</label>
          <input type="time" id="p_time" />
          <div style="margin-top:10px"><button type="submit">Registrar cita</button></div>
        </form>
        <div id="regMsg" class="small" style="margin-top:8px"></div>
      </div>
      <div class="card">
        <h2>Procedimientos y precios</h2>
        <div class="procedimientos" id="procedimientosList"></div>
      </div>
      <div class="card">
        <h2>Contacto / Redes</h2>
        <p class="small">Visítanos en Jr. Los Laureles, Juliaca. Reserva tu cita por la web o llama al +51 9XXXXXXXX</p>
        <div style="margin-top:8px">
          <h3 class="small">Redes sociales</h3>
          <div class="socials">
            <a href="#" id="fbLink" target="_blank">Facebook</a>
            <a href="#" id="igLink" target="_blank">Instagram</a>
            <a href="#" id="waLink" target="_blank">WhatsApp</a>
          </div>
        </div>
        <hr />
        <h3 class="small">Pacientes registrados</h3>
        <div id="patientsCount" class="pill">0</div>
      </div>
    </section>
    <section style="margin-top:18px">
      <div class="card">
        <h2>Lista de pacientes y próximas citas</h2>
        <table>
          <thead>
            <tr><th>Nombre</th><th>Documento</th><th>Teléfono</th><th>Fecha/Hora</th><th>Acciones</th></tr>
          </thead>
          <tbody id="patientsTable"></tbody>
        </table>
      </div>
    </section>
  </main>

  <div class="modal" id="adminModal">
    <div class="box card">
      <h2>Panel administrador</h2>
      <button id="closeAdmin">Cerrar</button>
      <hr />
      <div style="margin-top:8px">
        <h3>Pacientes</h3>
        <table>
          <thead><tr><th>Nombre</th><th>Doc</th><th>Próx. Cita</th><th>Último Proced.</th><th>Editar</th></tr></thead>
          <tbody id="adminPatients"></tbody>
        </table>
      </div>
      <hr />
      <div>
        <h3>Editar paciente / Registrar procedimiento</h3>
        <label>Seleccionar paciente</label>
        <select id="selPatient"></select>
        <label>Procedimiento</label>
        <select id="selProcedure"></select>
        <label>Fecha del procedimiento</label>
        <input type="date" id="procDate" />
        <label>Fecha próxima consulta</label>
        <input type="date" id="nextDate" />
        <div style="margin-top:8px"><button id="saveProcBtn">Guardar</button></div>
        <div id="adminMsg" class="small" style="margin-top:8px"></div>
      </div>
    </div>
  </div>

  <footer>
    © <span id="year"></span> Clínica DaVas — Jr. Los Laureles, Juliaca - Puno - Perú
  </footer>

  <script>
    const PROCEDIMIENTOS = [
      {id:'p1',name:'Limpieza dental',price:'S/ 80',img:'https://images.unsplash.com/photo-1588774068069-9f1b8e1f5b6d?auto=format&fit=crop&w=800&q=60'},
      {id:'p2',name:'Obturación (empaste)',price:'S/ 120',img:'https://images.unsplash.com/photo-1588774068007-7f4b3f4f2c3a?auto=format&fit=crop&w=800&q=60'},
      {id:'p3',name:'Endodoncia',price:'S/ 350',img:'https://images.unsplash.com/photo-1588776814546-4c9d3b8c4f3f?auto=format&fit=crop&w=800&q=60'},
      {id:'p4',name:'Extracción simple',price:'S/ 90',img:'https://images.unsplash.com/photo-1588774068166-2c2f4e5d7a7f?auto=format&fit=crop&w=800&q=60'},
      {id:'p5',name:'Profilaxis y pulido',price:'S/ 100',img:'https://images.unsplash.com/photo-1588774068199-6c1b9b3f2a2a?auto=format&fit=crop&w=800&q=60'},
      {id:'p6',name:'Blanqueamiento',price:'S/ 400',img:'https://images.unsplash.com/photo-1588774068211-1a1b1b1b1b1b?auto=format&fit=crop&w=800&q=60'}
    ];
    function loadPatients(){try{return JSON.parse(localStorage.getItem('dav_pacientes')||'[]')}catch(e){return[]}}
    function savePatients(list){localStorage.setItem('dav_pacientes',JSON.stringify(list))}
    const procContainer=document.getElementById('procedimientosList');
    PROCEDIMIENTOS.forEach(p=>{const div=document.createElement('div');div.className='proc-card card';div.innerHTML=`<img src="${p.img}" alt="${p.name}" /><div style="padding:8px"><strong>${p.name}</strong><div class="small">${p.price}</div></div>`;procContainer.appendChild(div)});
    const registerForm=document.getElementById('registerForm');const regMsg=document.getElementById('regMsg');
    function updatePatientsUI(){const list=loadPatients();document.getElementById('patientsCount').textContent=list.length;const tbody=document.getElementById('patientsTable');tbody.innerHTML='';list.forEach(p=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${p.name}</td><td>${p.doc}</td><td>${p.phone||''}</td><td>${p.nextDate|| (p.prefDate? p.prefDate+' '+(p.prefTime||''):'')}</td><td><button data-id="${p.id}" class="viewBtn">Ver</button></td>`;tbody.appendChild(tr)});const adminBody=document.getElementById('adminPatients');adminBody.innerHTML='';const sel=document.getElementById('selPatient');sel.innerHTML='';list.forEach(p=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${p.name}</td><td>${p.doc}</td><td>${p.nextDate||'-'}</td><td>${(p.history&&p.history.length)?p.history[p.history.length-1].procedure:'-'}</td><td><button data-id="${p.id}" class="editBtn">Editar</button></td>`;adminBody.appendChild(tr);const opt=document.createElement('option');opt.value=p.id;opt.textContent=p.name+' — '+p.doc;sel.appendChild(opt)});const selProc=document.getElementById('selProcedure');selProc.innerHTML='';PROCEDIMIENTOS.forEach(p=>{const o=document.createElement('option');o.value=p.id;o.textContent=p.name+' ('+p.price+')';selProc.appendChild(o)})}
    registerForm.addEventListener('submit',e=>{e.preventDefault();const p={id:'id_'+Date.now(),name:document.getElementById('p_name').value.trim(),doc:document.getElementById('p_doc').value.trim(),phone:document.getElementById('p_phone').value.trim(),email:document.getElementById('p_email').value.trim(),prefDate:document.getElementById('p_date').value,prefTime:document.getElementById('p_time').value,history:[],nextDate:null};const list=loadPatients();list.push(p);savePatients(list);updatePatientsUI();regMsg.textContent='Paciente registrado correctamente.';registerForm.reset();setTimeout(()=>regMsg.textContent='',2500)});
    document.addEventListener('click',e=>{if(e.target.classList.contains('viewBtn')){const id=e.target.dataset.id;const list=loadPatients();const p=list.find(x=>x.id===id);if(p){alert('Paciente: '+p.name+'\nDocumento: '+p.doc+'\nTel: '+(p.phone||'')+'\nPróx. cita: '+(p.nextDate||p.prefDate||'No definida')+'\nHistoria: '+(p.history&&p.history.length?JSON.stringify(p.history,null,2):'Sin procedimientos'))}}if(e.target.classList.contains('editBtn')){const id=e.target.dataset.id;document.getElementById('selPatient').value=id;document.getElementById('adminModal').classList.add('open')}});
    const adminModal=document.getElementById('adminModal');document.getElementById('closeAdmin').addEventListener('click',()=>adminModal.classList.remove('open'));
    document.getElementById('openAdminBtn').addEventListener('click',()=>{const pwd=prompt('Clave administrador:');if(pwd==='admin123'){adminModal.classList.add('open');updatePatientsUI()}else{alert('Contraseña incorrecta')}});
    document.getElementById('saveProcBtn').addEventListener('click',()=>{const pid=document.getElementById('selPatient').value;const procId=document.getElementById('selProcedure').value;const procDate=document.getElementById('procDate').value;const nextDate=document.getElementById('nextDate').value;if(!pid){document.getElementById('adminMsg').textContent='Seleccione un paciente.';return}const list=loadPatients();const p=list.find(x=>x.id===pid);const proc=PROCEDIMIENTOS.find(x=>x.id===procId)||{name:'Procedimiento desconocido',price:''};const entry={procedure:proc.name,date:procDate||new Date().toISOString().slice(0,10),price:proc.price};p.history=p.history||[];p.history.push(entry);if(nextDate)p.nextDate=nextDate;savePatients(list);updatePatientsUI();document.getElementById('adminMsg').textContent='Procedimiento registrado.';setTimeout(()=>document.getElementById('adminMsg').textContent='',2000)});
    document.getElementById('year').textContent=new Date().getFullYear();
    document.getElementById('fbLink').href='https://www.facebook.com/DaVasClinica';
    document.getElementById('igLink').href='https://www.instagram.com/DaVasClinica';
    document.getElementById('waLink').href='https://wa.me/519XXXXXXXX';
    updatePatientsUI();
  </script>
</body>
</html>